#sidebar Tutorial

<wiki:toc max_depth="1" />

= 简单介绍 =
AISpeech API `JavaScript` SDK，提供了录音，内核计算，结果处理的方法调用，减小了广大开发者开发语音应用的成本。

= 环境准备 = 
  # 请先准备一个Microphone
  # 浏览器： Firefox 3.5+, IE7+, Chrome 7+, Safari 5+
  # 网络环境： 此SDK客户端需要连接服务器1935端口，请确认您的网络设置没有屏蔽服务器1935端口。

= 简单例子 = 
  # 建立一个html页面，导入`JavaScript`文件：
 {{{
 <script type="text/javascript" src="load_core.js"></script>
}}}
  # 在body中加入一个div，此div是flash录音机的容器：
  {{{
<div id="aiRecorder1">
            <a href="http://www.adobe.com/go/getflashplayer">get flash player</a>
</div>
}}}
  # 新建`AudioRecorder`对象：
   * `AudioRecorder`对象是`JavaScript`对Flash录音机的封装，提供了在页面注入flash，操作flash的功能。
   * 构造一个`AudioRecorder`对象，
     * 参数 id， `AudioRecorder`实例的id，和容器div的id相同。
     * 参数 flashRecorderUrl， flash 录音机swf文件地址。
     * 参数 fmsList，服务器列表。
     * 回调 onFlashLoad， Flash加载事件回调。
     * 回调 onServerConnect，连接录音服务器的事件回调。
     * 回调 onMicDetect，Microphone事件回调。
     * 回调 onError，错误事件回调。
   * 代码：
{{{
     window.recorder1 = new aispeech.AiRecorder({
            id: "aiRecorder1",     //此处id和容器div的id相同
            showFlash: true,    
            flashRecorderUrl: "../airecorder/AudioRecorder4JS_developer_20110211_beta1.swf",    // flash录音机的路径。
            expressInstallUrl: "../common/expressInstall.swf",  
            serverList: fmsList,      //录音服务器列表 
            appKey: "1295337509549",
            secretKey: "391720efc00de450c56bbd7954171bc9af1b8ccf",
            onFlashLoad: function(code, message){

                aispeech.AiDebug.info("JS: onFlashLoad callback. code=" + code + ", message=" + JSON.stringify(message));

            },

            onConnectorStatusChange: function(code, message){

                window.T = message;

                aispeech.AiDebug.info("JS: onConnectorStatusChange callback. code=" + code + ", message=" + JSON.stringify(message));

            },

            onMicStatusChange: function(code, message){

                aispeech.AiDebug.info("JS: onMicStatusChange callback. code=" + code + ", message=" + JSON.stringify(message));

            },

            onError: function(code, message){

                aispeech.AiDebug.info("JS: onError callback. code=" + code + ", message=" + JSON.stringify(message));

            }
        });
       
 }}}
   * 注意：
     * 请确认swf地址正确。
     * 查看页面是否成功注入了flash对应的object节点。
  # 现在，你已经在页面添加了一个录音机组件，接下来你要添加一些操作按钮来控制录音机。增加一个开始录音按钮。对click添加处理函数：
   * 参数 duration，录音的时间长度，单位ms。
   * 参数 refText，本次录音对应的参考文本。
   * 参数 serverParams，语音服务的参数，清参考[ServiceList]。
   * 回调 onRecordIdGenerated，服务器为本次录音生成了唯一的文件id。
   * 回调 onStart， 录音开始事件。
   * 回调 onStop， 录音停止事件。
{{{
     function onStartRecordClick {
           var duration =  5000;  
           var refText = "ni2-hao3";   
            var r = recorder1.record({
                //recordId: recordId,
                duration: duration,       
                serverParams: {    
                    scoreType: 4,
                    coreType: "cn.word.score.v2.1",
                    refText: refText,
                    userId: "midfar@qq.com",
                    applicationId: "firstapp"
                },
               onRecordIdGenerated: function(code, message){

                    aispeech.AiDebug.info("JS: onRecordIdGenerated. code=" + code + ", message=" + JSON.stringify(message));

                   
                },

                onStart: function(code, message){

                    aispeech.AiDebug.info("AS: recordStart callback. code=" + code + ", message=" + JSON.stringify(message));

                },

                onStop: function(code, message){

                    aispeech.AiDebug.info("AS: recordStop callback. code=" + code + ", message=" + JSON.stringify(message));

                }
            });

}
 }}}
  # 增加一个结束录音按钮，对click事件添加处理函数：
{{{
function onStopRecordClick{
    
       recorder1.stop();
  
}
}}}
  # 现在你已经可以控制录音机开始录音和结束录音了。接下来需要获取语音评估结果，你可以调用getScores方法，
   * 返回值说明，参考[ServiceList]中不同coreType的返回值。
   * 代码：
{{{
  var lastRecordId = recorder1.getLastRecordId();
  recorder1.getScores({
                recordId: lastRecordId,  
               success: function(data){

                    aispeech.AiDebug.log("JS: getScores success.", data);

                }
            });
}}}
  # 如果你在上面的步骤遇到了困难，可以开启debug功能：
   * 首先在页面上包含一个log信息输出div:
{{{
<div id="aispeechAiDebug" class="aispeechAiDebug">

        </div>
}}}
   * 将日志输出到log信息区域中,需要修改jsLog的实现：
{{{
    function jsLog(text){

        aispeech.AiDebug.log(text);

    }
}}}

= 高级功能 =
  # Mic设置
  # 录音回放
  # 音量控制
  # 中文字词类应用，绘制声调曲线
  # 调试日志输出
  * 更多功能请参考[UserGuide]
= 问题排查 =
 请参考[FAQ]